{% extends "base.html" %}

{% block title %}Device Inventory - CobaltGraph{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>
                <i class="bi bi-hdd-network"></i> Device Inventory
                <span class="badge bg-primary" id="device-count">0</span>
            </h1>
            <div>
                <button class="btn btn-outline-secondary" id="refresh-btn">
                    <i class="bi bi-arrow-clockwise"></i> Refresh
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Filters -->
<div class="row mb-3">
    <div class="col-md-3">
        <select class="form-select" id="status-filter">
            <option value="">All Status</option>
            <option value="active">Active</option>
            <option value="idle">Idle</option>
            <option value="offline">Offline</option>
            <option value="discovered">Discovered</option>
        </select>
    </div>
    <div class="col-md-3">
        <input type="text" class="form-control" id="vendor-filter"
               placeholder="Filter by vendor...">
    </div>
    <div class="col-md-6">
        <input type="text" class="form-control" id="search-box"
               placeholder="Search by MAC or IP...">
    </div>
</div>

<!-- Device Table -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover" id="device-table">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>MAC Address</th>
                                <th>IP Address</th>
                                <th>Vendor</th>
                                <th>Type</th>
                                <th>First Seen</th>
                                <th>Last Seen</th>
                                <th>Connections</th>
                                <th>Threats</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="device-table-body">
                            <!-- Populated via htmx/WebSocket -->
                            <tr>
                                <td colspan="10" class="text-center text-muted">
                                    <div class="spinner-border spinner-border-sm me-2"></div>
                                    Loading devices...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Device Row Template (htmx will use this) -->
<template id="device-row-template">
    <tr class="device-row" data-mac="{mac_address}">
        <td>
            <span class="status-badge status-{status}">
                <i class="bi bi-circle-fill"></i> {status}
            </span>
        </td>
        <td>
            <code>{mac_address}</code>
        </td>
        <td>{ip_address}</td>
        <td>
            <span class="badge bg-secondary">{vendor}</span>
        </td>
        <td>{device_type}</td>
        <td class="text-muted small">{first_seen}</td>
        <td class="text-muted small">{last_seen}</td>
        <td>
            <span class="badge bg-info">{connection_count}</span>
        </td>
        <td>
            <span class="badge bg-danger">{threat_count}</span>
        </td>
        <td>
            <a href="/devices/{mac_address}" class="btn btn-sm btn-outline-primary">
                <i class="bi bi-eye"></i> View
            </a>
        </td>
    </tr>
</template>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/device-list.js') }}"></script>
{% endblock %}
