{% extends "base.html" %}

{% block title %}CobaltGraph - Network Monitoring Dashboard{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="text-center py-5">
            <h1 class="display-1">
                <i class="bi bi-eye-fill"></i> CobaltGraph
            </h1>
            <p class="lead text-muted">
                Passive Network Monitoring & Threat Detection
            </p>
            <p class="text-muted">
                Phase 0: Device Discovery MVP
            </p>
            <hr class="my-4">
            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                <a href="/devices" class="btn btn-primary btn-lg px-4">
                    <i class="bi bi-hdd-network"></i> View Devices
                </a>
                <a href="/api/devices/stats" class="btn btn-outline-secondary btn-lg px-4">
                    <i class="bi bi-bar-chart"></i> View Stats
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Quick Stats -->
<div class="row mt-5" id="quick-stats">
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-title text-muted">Total Devices</h6>
                <h2 class="mb-0" id="stat-total">-</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-title text-muted">Active Devices</h6>
                <h2 class="mb-0 text-success" id="stat-active">-</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-title text-muted">Idle Devices</h6>
                <h2 class="mb-0 text-warning" id="stat-idle">-</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-title text-muted">Offline Devices</h6>
                <h2 class="mb-0 text-secondary" id="stat-offline">-</h2>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Load stats on page load
document.addEventListener('DOMContentLoaded', async () => {
    try {
        const response = await fetch('/api/devices/stats');
        const data = await response.json();

        if (data.success) {
            document.getElementById('stat-total').textContent = data.total_devices;
            document.getElementById('stat-active').textContent = data.by_status.active || 0;
            document.getElementById('stat-idle').textContent = data.by_status.idle || 0;
            document.getElementById('stat-offline').textContent = data.by_status.offline || 0;
        }
    } catch (error) {
        console.error('Error loading stats:', error);
    }
});
</script>
{% endblock %}
